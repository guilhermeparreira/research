---
title: "Desafio: Predizendo o número de inscritos em canais do youtube"
author: "prof. Wagner Hugo Bonat LEG/UFPR"
date: 2019-03-29
---

```{r, cache=FALSE, include=FALSE}
source("config/setup.R")
```

O conjunto de dados $\texttt{youtube.csv}$ apresenta o número de 
$\textit{views}$ e inscritos desde o dia de sua abertura para dois canais 
de sucesso do $\textit{youtube}$. O objetivo é predizer o número **acumulado**
de inscritos em cada um destes canais para o próximo ano ($365$ dias).
Para isto você decidiu emprestar um modelo biológico do crescimento
de bactérias chamado modelo logístico, dado pela seguinte equação:
$$y = \frac{L}{1+ \exp(\beta(x - \beta_0)) }$$
onde $L$ é o valor máximo da curva, $\beta_0$ o valor de $x$ no ponto 
médio da curva e $\beta$ é a declividade da curva.

A Figura abaixo apresenta um gráfico do modelo logístico. 

```{r, echo = TRUE, fig.height= 5, fig.width=9}
par(mfrow = c(1,1), mar=c(2.6, 3, 1.2, 0.5), mgp = c(1.6, 0.6, 0))
f_log <- function(DIAS, L, beta, beta0) {
  out <- L/(1+ exp(-beta*(DIAS - beta0)))
  return(out)
}
DIAS <- 1:800
plot(f_log(DIAS = DIAS, L = 90, beta = 0.01, beta0 = 400) ~ DIAS, 
     ylab = "Número de inscritos", xlab = "Dias da abertura",
     type = "l", ylim = c(0,95))
abline(h = 90) 
text(x = 800, y = 93, label = "L")
text(x = 425, y = f_log(DIAS = 400, L = 90, beta = 0.01, beta0 = 400), 
     label = expression(beta))
points(x = 400, pch = 19, col = "red",
       y = f_log(DIAS = 400, L = 90, beta = 0.01, beta0 = 400))
```
Note que o modelo representa a intuição de como o número acumulado de
inscritos em um canal deve se comportar. No código $\texttt{R}$ abaixo
carrego a base de dados e organizo por canal.

```{r, echo = TRUE}
dados <- read.table("youtube.txt", header = TRUE)
dados_canal <- split(dados, dados$CANAL)
dados1 <- dados_canal[[1]]
dados2 <- dados_canal[[2]]
dados1$INSCRITOS <- dados1$INSCRITOS/100000
dados1$Y <- cumsum(dados1$INSCRITOS)
dados2$INSCRITOS <- dados2$INSCRITOS/100000
dados2$Y <- cumsum(dados2$INSCRITOS)
```

Podemos agora fazer o gráfico dos dados observados.

```{r, fig.height= 4, fig.width=8}
par(mfrow = c(1,2), mar=c(2.6, 3, 1.2, 0.5), mgp = c(1.6, 0.6, 0))
plot(dados1$Y ~ dados1$DIAS, xlim = c(0, 1215), ylim = c(0, 25),
     ylab = "Número de inscritos*100000", main = "Canal 1",
     xlab = "Dias", type = "o", cex = 0.1)
abline(v = 850)

plot(dados2$Y ~ dados2$DIAS, ylab = "Número de inscritos*100000", main = "Canal 2", 
     xlab = "Dias", ylim = c(0, 50), xlim = c(0, 980), type = "p", cex = 0.1)
abline(v = 607)
```
O objetivo deste projeto é ajustar o modelo logístico para os dados
de cada um destes canais e fazer uma predição de qual será o número
acumulado de inscritos para os próximos 365 dias.





